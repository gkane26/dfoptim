<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Nelder-Mead optimziation algorithm for derivative-free optimization — nmk • dfoptim</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
  
  
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">dfoptim</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/hwborchers/dfoptim/">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Nelder-Mead optimziation algorithm for derivative-free optimization</h1>
    </div>

    
    <p>An implementation of the Nelder-Mead algorithm for derivative-free optimization.  This allows bounds to be placed on parameters. Bounds are enforced by means of a parameter transformation.</p>
    

    <pre class="usage"><span class='fu'>nmk</span>(<span class='no'>par</span>, <span class='no'>fn</span>, <span class='kw'>control</span> <span class='kw'>=</span> <span class='fu'>list</span>(), <span class='no'>...</span>)

<span class='fu'>nmkb</span>(<span class='no'>par</span>, <span class='no'>fn</span>, <span class='kw'>lower</span><span class='kw'>=</span>-<span class='fl'>Inf</span>, <span class='kw'>upper</span><span class='kw'>=</span><span class='fl'>Inf</span>, <span class='kw'>control</span> <span class='kw'>=</span> <span class='fu'>list</span>(), <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>par</th>
      <td><p>A starting vector of parameter values. Must be feasible, i.e. lie strictly between lower and upper bounds.</p></td>
    </tr>
    <tr>
      <th>fn</th>
      <td><p>Nonlinear objective function that is to be optimized. 
      A scalar function that takes a real vector as argument and 
      returns a scalar that is the value of the function at that point 
      (see details).</p></td>
    </tr>
    <tr>
      <th>lower</th>
      <td><p>Lower bounds on the parameters.  A vector of the same length as the parameters.  If a single value is specified, it is assumed that the same lower bound applies to all parameters.</p></td>
    </tr>
    <tr>
      <th>upper</th>
      <td><p>Upper bounds on the parameters.  A vector of the same length as the parameters.  If a single value is specified, it is assumed that the same upper bound applies to all parameters.</p></td>
    </tr>
    <tr>
      <th>control</th>
      <td><p>A list of control parameters.  See *Details* for more information.</p></td>
    </tr>
    <tr>
      <th>&#8230;</th>
      <td><p>Additional arguments passed to <code>fn</code></p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Argument <code>control</code> is a list specifing any changes to default values of algorithm control parameters for the outer loop.  Note that the names of these must be specified completely.  Partial matching will not work.  The list items are as follows:
    <code>tol</code> Convergence tolerance.  Iteration is terminated when the absolute difference in function value between successive iteration is below <code>tol</code>.  Default is 1.e-06.
    <code>maxfeval</code>: Maximum number of objective function evaluations allowed.  Default is min(5000, max(1500, 20*length(par)^2)).
    <code>regsimp</code> A logical variable indicating whether the starting parameter configuration is a regular simplex.  Default is TRUE.
    <code>maximize</code> A logical variable indicating whether the objective function should be maximized.  Default is FALSE.
    <code>restarts.max</code> Maximum number of times the algorithm should be restarted before declaring failure. Default is 3.
    <code>trace</code> A logical variable indicating whether the starting parameter configuration is a regular simplex.  Default is FALSE.</p>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list with the following components:</p>
<dt>par</dt><dd><p>Best estimate of the parameter vector found by the algorithm.</p></dd>

<dt>value</dt><dd><p>The value of the objective function at termination.</p></dd>

<dt>feval</dt><dd><p>The number of times the objective <code>fn</code> was evaluated.</p></dd>

<dt>restarts</dt><dd><p>The number of times the algorithm had to be restarted when it stagnated.</p></dd>

<dt>convergence</dt><dd><p>An integer code indicating type of convergence.  <code>0</code> indicates successful convergence. Positive integer codes indicate failure to converge.</p></dd>

<dt>message</dt><dd><p>Text message indicating the type of convergence or failure.</p></dd>


    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>C.T. Kelley (1999), Iterative Methods for Optimization, SIAM.</p>
    
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>This algorithm is based on the Matlab code of Prof. C.T. Kelley, given in his book "Iterative methods for optimization".
It is implemented here with the permission of Prof. Kelley and SIAM.  However, there are some non-trivial modifications of the algorithm.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <p><code>optim</code>, <code><a href='hookejeeves.html'>hjk</a></code></p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'> <span class='no'>rosbkext</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>x</span>){
<span class='co'># Extended Rosenbrock function</span>
 <span class='no'>n</span> <span class='kw'>&lt;-</span> <span class='fu'>length</span>(<span class='no'>x</span>)
 <span class='fu'>sum</span> (<span class='fl'>100</span>*(<span class='no'>x</span>[<span class='fl'>1</span>:(<span class='no'>n</span>-<span class='fl'>1</span>)]^<span class='fl'>2</span> - <span class='no'>x</span>[<span class='fl'>2</span>:<span class='no'>n</span>])^<span class='fl'>2</span> + (<span class='no'>x</span>[<span class='fl'>1</span>:(<span class='no'>n</span>-<span class='fl'>1</span>)] - <span class='fl'>1</span>)^<span class='fl'>2</span>)
 }

<span class='no'>np</span> <span class='kw'>&lt;-</span> <span class='fl'>10</span>
<span class='fu'>set.seed</span>(<span class='fl'>123</span>)

<span class='no'>p0</span> <span class='kw'>&lt;-</span> <span class='fu'>rnorm</span>(<span class='no'>np</span>)
<span class='no'>xm1</span> <span class='kw'>&lt;-</span> <span class='fu'>nmk</span>(<span class='kw'>fn</span><span class='kw'>=</span><span class='no'>rosbkext</span>, <span class='kw'>par</span><span class='kw'>=</span><span class='no'>p0</span>) <span class='co'># maximum `fevals' is not sufficient to find correct minimum</span>
<span class='no'>xm1b</span> <span class='kw'>&lt;-</span> <span class='fu'>nmkb</span>(<span class='kw'>fn</span><span class='kw'>=</span><span class='no'>rosbkext</span>, <span class='kw'>par</span><span class='kw'>=</span><span class='no'>p0</span>, <span class='kw'>lower</span><span class='kw'>=</span>-<span class='fl'>2</span>, <span class='kw'>upper</span><span class='kw'>=</span><span class='fl'>2</span>)

<span class='co'>### A non-smooth problem</span>
<span class='no'>hald</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>x</span>) {
<span class='co'>#Hald J &amp; Madsen K (1981), Combined LP and quasi-Newton methods </span>
<span class='co'>#for minimax optimization, Mathematical Programming, 20, p.42-62.</span>
        <span class='no'>i</span> <span class='kw'>&lt;-</span> <span class='fl'>1</span>:<span class='fl'>21</span>
        <span class='no'>t</span> <span class='kw'>&lt;-</span> -<span class='fl'>1</span> + (<span class='no'>i</span> - <span class='fl'>1</span>)/<span class='fl'>10</span>
        <span class='no'>f</span> <span class='kw'>&lt;-</span> (<span class='no'>x</span>[<span class='fl'>1</span>] + <span class='no'>x</span>[<span class='fl'>2</span>] * <span class='no'>t</span>) / ( <span class='fl'>1</span> + <span class='no'>x</span>[<span class='fl'>3</span>]*<span class='no'>t</span> + <span class='no'>x</span>[<span class='fl'>4</span>]*<span class='no'>t</span>^<span class='fl'>2</span> + <span class='no'>x</span>[<span class='fl'>5</span>]*<span class='no'>t</span>^<span class='fl'>3</span>) - <span class='fu'>exp</span>(<span class='no'>t</span>)
        <span class='fu'>max</span>(<span class='fu'>abs</span>(<span class='no'>f</span>))
        }

<span class='no'>p0</span> <span class='kw'>&lt;-</span> <span class='fu'>runif</span>(<span class='fl'>5</span>)
<span class='no'>xm2</span> <span class='kw'>&lt;-</span> <span class='fu'>nmk</span>(<span class='kw'>fn</span><span class='kw'>=</span><span class='no'>hald</span>, <span class='kw'>par</span><span class='kw'>=</span><span class='no'>p0</span>)
<span class='no'>xm2b</span> <span class='kw'>&lt;-</span> <span class='fu'>nmkb</span>(<span class='kw'>fn</span><span class='kw'>=</span><span class='no'>hald</span>, <span class='kw'>par</span><span class='kw'>=</span><span class='no'>p0</span>, <span class='kw'>lower</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,-<span class='fl'>2</span>), <span class='kw'>upper</span><span class='kw'>=</span><span class='fl'>4</span>)

<span class='co'>## Another non-smooth functions</span>
  <span class='no'>nsf</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>x</span>) {
        <span class='no'>f1</span> <span class='kw'>&lt;-</span> <span class='no'>x</span>[<span class='fl'>1</span>]^<span class='fl'>2</span> + <span class='no'>x</span>[<span class='fl'>2</span>]^<span class='fl'>2</span>
        <span class='no'>f2</span> <span class='kw'>&lt;-</span> <span class='no'>x</span>[<span class='fl'>1</span>]^<span class='fl'>2</span> + <span class='no'>x</span>[<span class='fl'>2</span>]^<span class='fl'>2</span> + <span class='fl'>10</span> * (-<span class='fl'>4</span>*<span class='no'>x</span>[<span class='fl'>1</span>] - <span class='no'>x</span>[<span class='fl'>2</span>] + <span class='fl'>4</span>)
        <span class='no'>f3</span> <span class='kw'>&lt;-</span> <span class='no'>x</span>[<span class='fl'>1</span>]^<span class='fl'>2</span> + <span class='no'>x</span>[<span class='fl'>2</span>]^<span class='fl'>2</span> + <span class='fl'>10</span> * (-<span class='no'>x</span>[<span class='fl'>1</span>] - <span class='fl'>2</span>*<span class='no'>x</span>[<span class='fl'>2</span>] + <span class='fl'>6</span>)
        <span class='fu'>max</span>(<span class='no'>f1</span>, <span class='no'>f2</span>, <span class='no'>f3</span>)
  }
<span class='no'>par0</span> <span class='kw'>&lt;-</span> <span class='fu'>c</span>(<span class='fl'>1</span>, <span class='fl'>1</span>)                                 <span class='co'># true min 7.2 at (1.2, 2.4)</span>
<span class='fu'>nmk</span>(<span class='no'>par0</span>, <span class='no'>nsf</span>) <span class='co'># fmin=8 at xmin=(2,2)</span></div><div class='output co'>#&gt; $par
#&gt; [1] 1.199650 2.400175
#&gt; 
#&gt; $value
#&gt; [1] 7.2
#&gt; 
#&gt; $feval
#&gt; [1] 83
#&gt; 
#&gt; $restarts
#&gt; [1] 0
#&gt; 
#&gt; $convergence
#&gt; [1] 0
#&gt; 
#&gt; $message
#&gt; [1] "Successful convergence"
#&gt; </div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#details">Details</a></li>

      <li><a href="#value">Value</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#note">Note</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    
Ravi Varadhan &lt;rvaradhan@jhmi.edu&gt;, Johns Hopkins University
URL:http://www.jhsph.edu/agingandhealth/People/Faculty_personal_pages/Varadhan.html

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Ravi Varadhan, Hans W. Borchers.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
